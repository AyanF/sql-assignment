CREATE DATABASE hotwaxSystem;

USE hotwaxSystem;

CREATE TABLE SalesPeople(
SNUM int PRIMARY KEY,
SNAME varchar(255),
CITY varchar(255),
COMM int
);

CREATE TABLE Customers(
CNUM int PRIMARY KEY,
CNAME varchar(255),
CITY varchar(255),
RATING int,
SNUM INT,
FOREIGN KEY (SNUM) REFERENCES SalesPeople (SNUM)
);

CREATE TABLE Orders(
ONUM int,
AMT decimal(8,2),
ODATE date,
CNUM int,
SNUM int,
FOREIGN KEY (CNUM) REFERENCES Customers(CNUM),
FOREIGN KEY (SNUM) REFERENCES SalesPeople(SNUM)
);

INSERT INTO SalesPeople VALUES 
(1001,"Peel","London",.12),
(1001,"Serres","SanJose",.13),
(1004,"Motika","London",.11),
(1007,"Rifkn","Barcelona",.15),
(1003,"AxelRod","New York",.10),
(1008,"Fran","London",.25);

INSERT INTO Customers VALUES 
(2001,"Hoffman","London",100,1001),
(2002,"Giovanni","Rome",200,1003),
(2003,"Liu","SanJose",200,1002),
(2004,"Grass","Berlin",300,1002),
(2005,"Clemens","London",100,1001),
(2006,"Cisneros","SanJose",300,1007),
(2007,"Pereira","Rome",100,1004);

INSERT INTO Orders VALUES 
(3001,18.69,'1990-10-03',2008,1007),
(3003,767.19,'1990-10-03',2001,1001),
(3002,1900.10,'1990-10-03',2007,1004),
(3005,5160.45,'1990-10-03',2003,1002),
(3006,1098.16,'1990-10-03',2008,1007),
(3009,1713.23,'1990-10-03',2002,1003),
(3007,75.75,'1990-10-03',2004,1002),
(3008,4723.00,'1990-10-03',2006,1001),
(3010,1309.95,'1990-10-03',2004,1002),
(3011,9891.88,'1990-10-03',2006,1001);


Questions--

1) List all the columns of the Salespeople table. 
A) SHOW COLUMNS FROM SalesPeople;

2) List all customers with a rating of 100. 
A) SELECT * FROM Customers WHERE rating = 100;

3) Find the largest order taken by each salesperson on each date. 
A) SELECT snum,odate,MAX(amt) FROM orders GROUP BY odate,snum;

4) Arrange the Order table by descending customer number. 
A) SELECT * FROM orders ORDER BY cnum DESC;

5) Find which salespeople currently have orders in the order table. 
A) SELECT cname FROM customers WHERE snum IN (SELECT snum FROM salespeople);

6) List names of all customers matched with the salespeople serving them. 
A) SELECT sname , snum FROM saleSpeople WHERE snum IN(SELECT snum FROM customers GROUP BY snum HAVING count(snum)>1);	

7) Find the names and numbers of all salespeople who have more than one customer. 
A) SELECT sname , snum FROM saleSpeople WHERE snum IN(SELECT snum FROM customers GROUP BY snum HAVING count(snum)>1);

8) Count the orders of each of the salespeople and output the results in descending order. 
A) SELECT count(onum), snum FROM Orders GROUP BY snum ORDER BY count(onum) DESC;


9) List the customer table if and only if one or more of the customers in the Customer table are located in SanJose. 
A) SELECT * FROM customers WHERE (SELECT count(*) FROM customers WHERE city='SanJose')>1;

10) Match salespeople to customers according to what city they live in. 
A) SELECT sname, cname, s.city FROM salespeople s,customers c where s.city=c.city;

11) Find all the customers in SanJose who have a rating above 200. 
A) SELECT cname FROM customers WHERE city ="SanJose" AND rating>200;

12) List the names and commissions of all salespeople in London. 
A) SELECT sname, comm FROM salespeople WHERE city="London"; 

13) List all the orders of Salesperson Motika from the orders table.
A) SELECT  a.onum, a.amt, a.odate from Orders a WHERE snum=(SELECT snum FROM salespeople WHERE sname='Motika');

14) Find all customers who booked orders on October 3. 
A) SELECT c.cname FROM customers c LEFT JOIN orders o ON c.cnum = o.cnum WHERE o.odate ='1990-10-03';

15) Give the sums of the amounts from the Orders table, grouped by date, eliminating all those dates where the SUM was not at least 2000 above the maximum Amount. 
A) SELECT odate,sum(amt) FROM orders GROUP BY odate;

16) Select all orders that had amounts that were greater than at least one of the orders from October 6. 
A) SELECT o.onum FROM orders o WHERE o.amt> (SELECT amt FROM orders WHERE odate='1990-10-06' ORDER BY amt LIMIT 1);

17) Write a query that uses the EXISTS operator to extract all salespeople who have customers with a rating of 300. 
A) SELECT s.sname, s.snum FROM salespeople s WHERE EXISTS (SELECT cname FROM customers WHERE rating=300);

18) Find all customers whose cnum is 1000 above the snum of Serres. 
A) SELECT cnum,cname FROM customers WHERE cnum>1000+(SELECT snum FROM salespeople WHERE sname='serres');

19) Give the salespeople’s commissions as percentages instead of decimal numbers. 
A) SELECT comm*100 AS comm  FROM salespeople;

20) Find the largest order taken by each salesperson on each date, eliminating those Maximum orders, which are less than 3000. 
A) SELECT snum,odate,max(amt) FROM orders GROUP BY odate,snum HAVING max(amt)>3000;

21) List all the largest orders for October 3, for each salesperson. 
A) SELECT b.sname, o.snum,o.odate,o.onum,o.amt FROM orders o, salespeople b, customers a WHERE odate='1990-10-03' AND a.snum=b.snum AND  a.snum=o.snum ORDER BY o.amt DESC;

22) Find all customers located in cities where Serres has customers. 
A) SELECT c.cname FROM customers c WHERE c.city = (SELECT c.city FROM customers c WHERE snum=(SELECT s.snum FROM salespeople s WHERE s.sname='Serres' )LIMIT 1);

23) Select all customers with a rating above 200. 
A) SELECT c.cname FROM customers c WHERE c.rating >200;

24) Count the number of salespeople currently having orders in the orders table. 
A) SELECT count(snum) FROM orders;
	
25) Write a query that produces all customers serviced by salespeople with a commission above 12%. Output the customer’s name, salesperson’s name and the salesperson’s rate of commission.
A) SELECT count(DISTINCT snum) FROM orders;

26) Find salespeople who have multiple customers. 
A) SELECT c.snum, count(c.snum) FROM customers c GROUP BY c.snum HAVING count(c.snum)>1;

27) Find salespeople with customers located in their own cities. 
A) SELECT DISTINCT s.sname FROM salespeople s, customers c WHERE c.snum=s.snum AND  c.city = s.city;

28) Find all salespeople whose name starts with ‘P’ and fourth character is ‘I’. 
A) SELECT s.sname FROM salespeople s WHERE s.sname LIKE 'p__i%';

29) Write a query that uses a subquery to obtain all orders for the customer named ‘Cisneros’. Assume you do not know his customer number.
A) SELECT o.onum FROM orders o WHERE o.cnum = (SELECT c.cnum FROM customers c WHERE c.cname='Cisneros');

30) Find the largest orders for Serres and Rifkin. 
A) SELECT snum,max(amt) FROM orders GROUP BY snum  HAVING snum IN(SELECT snum FROM salespeople WHERE sname='Serres' OR sname='Rifkin');

31) Sort the salespeople table in the following order: snum, sname, commission, city. 
32) Select all customers whose names fall in between ‘A’ and ‘G’ alphabetical range. 
33) Select all the possible combinations of customers you can assign. 
34) Select all orders that are greater than the average for October 4. 
35) Write a select command using correlated subquery that selects the names and numbers of all customers with ratings equal to the maximum for their city. 











